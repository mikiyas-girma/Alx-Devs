import{m as S,u as k,a as t,r as c,n as A,o as E,p as R,q as w,j as e,L as T,t as L,v as B}from"./index-BFXp2l_r.js";import{C as D,a as F,b as H,d as x,e as j}from"./card-C4D_LmsY.js";import{S as f}from"./separator-pSySfMqJ.js";const q=()=>{const{id:a}=S(),o=k(),m=t(s=>s.user.loggeduser),r=t(s=>s.projects.currentProject),l=t(s=>s.teams.teams[a]);t(s=>s.userProjects.teams),t(s=>s.userProjects.application_status),t(s=>s.userProjects.form_status);const p=t(s=>s.projects.creator),h=t(s=>s.projects.status),v=t(s=>s.projects.error),[u,b]=c.useState({}),[n,g]=c.useState(""),{toast:d}=A();if(c.useEffect(()=>{(!r||r.id!==a)&&o(E(a)),r&&r.creator_id&&(b(r.roles),o(R(r.creator_id)))},[a,r,o]),c.useEffect(()=>{l||o(w({project_id:a}))},[o,a,l]),h=="loading")return e.jsx("div",{children:"Loading..."});if(h=="failed")return e.jsx("div",{children:v});if(!r)return e.jsx("div",{children:"Project not found"});const N=s=>{g(s.target.value)},y=()=>{if(!n){d({title:"Error",description:"Please select a role",status:"error",duration:2e3,variant:"destructive"});return}o(L({project_id:r.id,role:n})).then(s=>{s.type.endsWith("fulfilled")?(o(B({project_id:a,user:s.payload})),d({title:"Success",description:"Application submitted successfully",status:"success",duration:2e3,variant:"success"})):s.type.endsWith("rejected")&&(console.log(s),d({title:"Error",description:"You already applied to this project",status:"error",duration:2e3,variant:"destructive"}))})};if(!l)return e.jsx("div",{children:"Loading... "});const{team:P,team_members:_}=l;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"m-4",children:[e.jsxs(D,{className:"flex min-h-full",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(F,{className:"text-center",children:e.jsx(H,{children:r.title})}),e.jsx(x,{className:"",children:e.jsx("p",{className:"font-serif ",children:r.description})}),e.jsxs("div",{className:"ml-6 p-2 ",children:[p&&e.jsxs("p",{children:["Project Creator: ",p.name]}),r.proposal&&e.jsxs("p",{className:"",children:["Proposal Link:",e.jsxs("a",{className:"text-blue-900",href:r.proposal,target:"_blank",rel:"noopener noreferrer",children:[e.jsx("span",{children:" "})," ",r.proposal]})]})]}),m.id!==r.creator_id&&e.jsx("div",{children:e.jsxs("div",{className:"p-4 m-auto",children:[e.jsx("h2",{className:"text-lg font-bold mb-2",children:"Select a Role & Apply"}),e.jsx("div",{className:"flex flex-col",children:Object.keys(u).map(s=>e.jsx("div",{className:"mb-2",children:u[s].map((i,C)=>e.jsxs("label",{className:"inline-flex items-center mt-2",children:[e.jsx("input",{type:"radio",name:"role",value:i,checked:n===i,onChange:N,className:"form-radio"}),e.jsx("span",{className:"ml-2",children:i})]},C))},s))})]})}),m.id!==r.creator_id?e.jsx(j,{className:"justify-center",children:e.jsx("div",{className:"p-[3px] relative",children:e.jsx("button",{className:` mt-2 bg-gradient-to-r from-green-400 via-green-500 to-green-500 
                                    hover:bg-gradient-to-r hover:from-blue-500 hover:via-blue-600 hover:to-blue-600 
                                    text-white font-semibold py-2 px-4 border border-gray-400 rounded-md shadow`,type:"submit",onClick:y,children:"Apply Here"})})}):e.jsx(j,{className:"justify-center",children:e.jsx("div",{className:"p-[3px] relative",children:e.jsx("button",{className:` mt-2 bg-gradient-to-r from-green-400 via-green-500 to-green-500 
                                    hover:bg-gradient-to-r hover:from-blue-500 hover:via-blue-600 hover:to-blue-600 
                                    text-white font-semibold py-2 px-4 border border-gray-400 rounded-md shadow`,type:"submit",children:"Edit Project"})})})]}),e.jsx("div",{className:"flex-1 m-6 ",children:e.jsxs("div",{className:"",children:[e.jsx("p",{className:"text-green-600",children:"Already Joined Members:"}),e.jsx(f,{}),e.jsx("div",{className:"",children:e.jsx(x,{className:"text-left p-4",children:P.map(s=>{var i;return e.jsxs("div",{className:"p-2",children:[e.jsxs("span",{className:"px-4",children:["Name:",(i=_[s.user_id])==null?void 0:i.name," "]}),e.jsxs("span",{className:"px-4",children:["Role: ",s.role]}),e.jsxs("span",{className:"px-4",children:["Status: ",s.status]}),e.jsx(f,{})]},s.id)})})})]})})]}),e.jsx("div",{className:"text-center",children:e.jsx(T,{to:"/home",children:e.jsx("button",{className:` mt-2 bg-gradient-to-r from-blue-400 via-blue-500 to-violet-500 
                                    hover:bg-gradient-to-r hover:from-blue-500 hover:via-blue-600 hover:to-blue-600 
                                    text-white font-semibold py-2 px-4 border border-gray-400 rounded-md shadow`,children:"See Another Projects"})})})]})})};export{q as default};
